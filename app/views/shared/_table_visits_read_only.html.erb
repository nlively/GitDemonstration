<%

   unless defined? show_data
     show_data = true
   end

   unless defined? mode
     mode = :both
   end

   show_client = (mode == :both || mode == :client)
   show_employee = (mode == :both || mode == :employee)

%>
<table id="visits" class="visits read-only">
  <thead>
  <tr>
    <th>Date</th>
    <% if show_client %>
        <th>Client</th>
    <% end %>
    <% if show_employee %>
        <th>Employee</th>
    <% end %>
    <th>Pay Rate</th>
    <th>Bill Rate</th>
    <th>In</th>
    <th>Out</th>
    <th>Duration</th>
    <th>Location</th>
    <% if show_data %>
        <th>Data</th>
    <% end %>
  </tr>
  </thead>
  <tbody>
  <% visits.each do |visit| %>
      <tr class="visit-row">
        <td class="date">
          <%= visit.date_only_formatted %>
        </td>
        <% if show_client %>
            <td class="person client">
              <%= visit.client_label %>
            </td>
        <% end %>
        <% if show_employee %>
            <td class="person employee">
              <%= visit.employee_label %>
            </td>
        <% end %>
        <td class="payrate">
          <%= visit.pay_rate_formatted %>
        </td>
        <td class="billrate">
          <%= visit.bill_rate_formatted %>
        </td>
        <td class="in-time">
          <%= visit.in_time_time_only %>
        </td>
        <td class="out-time">
          <%= render 'shared/visit_icon', :visit => visit %>
          <%= visit.out_time_time_only %>
        </td>
        <td class="duration">
          <%= visit.duration_string %>
        </td>
        <td class="location">
          <%= visit.location_label %>
        </td>
        <% if show_data %>
            <td class="data">
              <%= link_to 'view', dashboard_visit_path(visit) %>
            </td>
        <% end %>
      </tr>
  <% end %>
  </tbody>
</table>